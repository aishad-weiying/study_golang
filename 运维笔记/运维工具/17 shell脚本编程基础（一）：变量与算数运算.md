# shell脚本的规范与使用

1. 第一行必须包括shell声明序列
	例：#!/bin/bash

2. 以#开头表示注释

3. shell脚本文件一般以.sh结尾

4. 运行脚本

- 方法一：给shell脚本文件执行权限，直接执行即可./file_name.sh

- 方法二：执行使用解释器运行，将脚本文件作为解释器程序的参数
	bash file_name.sh

5. 脚本调试

- 检测脚本中的语法错误
	bash -n /path/to/file_name.sh

- 调试执行
	bash -x /path/to/file_name.sh

# shell的变量

- 变量：命名的内存空间

- 变量的作用：
	1.数据的存储方式
	2.参与的运算
	3.表示的数据范围

- 变量的类型：
	字符型
	数值型：整形、浮点型

> bash把所有存储的数据，统当做字符进行存储

- 变量的命名规则：
	1.不能使用程序中的保留字：例如if、for等
	2.只能使用数字、字母及下划线，且不能以数字开头
	3.见名知义
	4.统一命名规则：驼峰命名法

- bash的变量种类：根据变量的生效范围等标准划分
	1.局部变量：当前shell进程的代码片段
	2.环境变量：当前shell进程的代码片段
	3.本地变量:生效范围是当前shell进程
	4.位置变量：$1,$2.....来表示，用于脚本中调用通过命令行传递的参数
	5.特殊变量：$?上一条命令的执行结果状态；0表示执行成功

## 局部变量
生效范围是当前shell进程

- 变量声明、赋值：name=value
vlaue的值可以是一下几种：
	1.直接给定字符串：name="root"
	2.变量引用：name="$USER"或${name} 
	3.命令引用：name=`COMMADN`或者name=$(COMMAND)

> 注：在变量引用中
> 双引号表示弱引用：其中的变量引用会被替换为变量值
> 单引号表示强引用：其中的变量引用不会被替换为变量值，而保持原字符串

- 显示已经定义的所有变量：set

- 删除变量：unset name

## 环境变量
生效范围是当前shell进程及其子shell进程

- 变量声明、赋值：
	export name=value
	declare -x name=value

- 变量引用：
	$name或者${name}

- 显示所有的环境变量
	env、printenv、export、declare -x、

- 删除环境变量
	unset name

- bash内建的环境变量：
	PATH,SHELL,USER,UID,HOME,PWD,SHLVL,LANG,MAIL,HOSTNAME,HISTSIZE,_,....等

```bash
"$-"变量的详细说明:
	h：hashall，打开这个选项后，Shell会将命令所在的路径hash下来，避免每次都要查询。通过set +h将h选项关闭
	i：interactive-comments，包含这个选项说明当前的 shell 是一个交互式的shell。所谓的交互式shell,在脚本中，i选项是关闭的。
	m：monitor，打开监控模式，就可以通过Job control来控制进程的停止、继续，后台或者前台执行等。
	B：braceexpand，大括号扩展
	H：history，H选项打开，可以展开历史列表中的命令，可以通过!感叹号来完成，例如“!!”返回上最近的一个历史命令，“!n”返回第 n 个历史命令

	通过set +h选项： 关闭摸个指定的功能
```

## 只读变量
只能声明，但是不能修改或删除

- 声明只读变量
	readonly name
	declare -r name

- 查看只能只读变量
	readonly -p

## 位置变量
用于脚本中调用通过命令行传递的给脚本的参数

- $1,$2,....,$n:对应第一个，第二个...第n个参数,（可以使用shitf换挡，shift n 一次换挡n个）

- $0:命令本身

- $* :传递给脚本的所有参数，全部参数合为一个字符串

- $@ ：传递给脚本的所有参数，每个参数为独立的字符串

- $# ：传递的参数个数

- 清空所有的位置变量
	set  - -

> 注意：$@或$* 只在被双引号包起来的时候才会有差异

## 特殊变量

- $?上一条命令的执行结果状态；0表示执行成功

- $$:当前所在终端的PID

## 程序的退出状态码
进程使用退出状态来报告成功或失败
	0 代表成功，1－255代表失败

- bash自定义退出状态码
	exit [n]：自定义退出状态码
	脚本中一旦遇到exit命令，脚本会立即终止；终止退出状态取决于exit命令后面的数字

> 注：如果未给脚本指定退出状态码，整个脚本的退出状态码取决于脚本中执行的最后一条命令的状态码

# bash的配置文件

1. 按照生效范围划分

- 全局配置文件：/etc/profile、/etc/profile.d/*.sh、/etc/bashrc

- 个人配置文件：~/.bash.profile、~/.bashrc

2. 按照功能划分：

- profile类：为交互式登录的shell提供配置
	全局：/etc/profile、/etc/profile.d/*.sh
	个人：~/.bash.profile
	主要用途：
		1.用于定义环境变量
		2.运行命令或脚本

- bashrc类：为非交互式登录的射可可提供配置

 	全局：/etc/bashrc
 	个人：~/.bashrc
 	主要用途：
 		1.用来定义命令别名,函数
 		2.定义本地变量
```bash
# shell的登录：
	交互式登录
		1.直接通过终端输入账号密码登录
		2.使用su - username 切换的用户
		读取配置文件的顺序：
			/etc/profile -> /etc/profile.d/*.sh -> ~/.bash.profile -> ~/.bashrc ->/etc/bashrc 
	非交互式登录
		1.su username
		2.图形界面下打开的终端
		3.执行脚本时脚本运行时脚本单独打开的shell进程运行脚本
		读取配置文件的顺序：
			/etc/profile.d/*.sh -> /etc/bashrc ->  ~/.bashrc
# bash退出任务
	保存在~/.bash_logout文件中（用户）
		在退出登录shell时运行
		作用：
			• 创建自动备份
			• 清除临时文件
```

# bash的算数运算符：+,-,/,*,%,**

1. let 变量=算数运算表达式
	将算数运算表达式的结果赋值给变量

2. 变量=$[算数运算表达式]

3. 变量=$((算数运算表达式))

4. 变量=$(expr 被操作数 符号 操作数 ...)
	（符号需要转义，操作数为变量需要加$）

5. declare -i var=算数运算表达式

6. 随机数生成器:$RANDOM(0-32627)
	随机生成0-60之间的数：echo $(RANDOM%60+1)

7. 增强型赋值：+=、-=、*=、/=、%=、++、--
	例：let val++

# bash逻辑运算
TRUE(0)、FALSE(1)
	与：当且仅当都为真，结果为真 &&
	或：当且仅当都为假，结果为假 ||
	非：对结果取反 !
	异或：两个相同为假，不同为真

- 短路与
	第一个为0，结果必定为0
	第一个为1，第二个必须要参与运算

- 短路或
	第一个为1，结果必定为1
	第一个为0，第二个必须要参与运算

- 异或：^
	异或的两个值，相同为假，不同为真